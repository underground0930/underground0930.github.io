<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		body{
		}
    #mainVisual{
      width:100%;
      height:100vh;
      background: #f00;
    }
    #footer{
      height: 300px;
      background: #0f0;
    }
		#wrap{
			width: 100%;
/*			background: url(abc.jpg) repeat;*/
		}
		.inertia{
      width:300px;
      height:300px;
      background: #00f;
      border:1px solid #000;
      font-size:100px;
		}
    section{
      width:100%;
      height:450px;
    }

	</style>
</head>
<body>
	<div id="wrap">
  <div id="mainVisual" class="translateObj">
    <h1>メインビジュアル</h1>
  </div>
  <section>
    <div class="inertia" data-dur="10">1</div>
  </section>
  <section>
    <div class="inertia" data-dur="2">2</div>
  </section>
  <section>
    <div class="inertia" data-dur="3">3</div>
  </section>
  <section>
    <div class="inertia" data-dur="1">4</div>
  </section>
  <section>
    <div class="inertia" data-dur="2">5</div>
  </section>
  <section>
    <div class="inertia" data-dur="3">6</div>
  </section>
  <section>
    <div class="inertia" data-dur="2">7</div>
  </section>
  <footer id="footer">
    <h1>フッター</h1>
  </footer>
	</div>
  <script src="./jquery-1.9.1.min.js"></script>
	<!-- <script src="./inertiaScroll.js"></script> -->
	<script>
(function($){
  $.fn.inertiaScroll = function(options,parent){

    var $window = $(window);
    var $body = $("body");
    var $parent = $(parent);
    var $this = this;

    var moveParent = 0; // 親要素のスクロール量
    var moveChild = 0; // 子要素のスクロール量
    var windowOffset = 0;　// ウィンドウの今のオフセット
    var oldOffset = 0;　// ウィンドウの前のオフセット
    var subtraction = 0; // スクロール量の差
  //  var rateArray = []; // それぞれの要素の慣性の倍率を格納する
  //    $this.each(function(){
  //      var dur = $(this).data("dur");
  //      rateArray.push(dur);
  //    });

    function smoothScroll(){
        windowOffset = $window.scrollTop();
        moveParent += (windowOffset - moveParent) * 0.08;
        moveChild += (windowOffset * 0.1 - moveChild) * 0.03;

        $parent.css({transform:"translate3d(" + 0 + "," + -moveParent  + "px ," + 0 +")"});
        $this.each(function(i){
            $(this).css({transform:"translate3d(" + 0 + "," + -moveChild  + "px ," + 0 +")"});
        });
 
        requestAnimationFrame(smoothScroll)
    }
   smoothScroll();

  $parent.css({
    "position":"fixed"
  });

  $window
    .on("load.inertiaScroll",function(){
      $body.height($parent.height());
    });
  };
})(jQuery);

		$(function(){
      $(".inertia").inertiaScroll({},"#wrap");
		});
	</script>
</body>
</html>